<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>三维动画与交互技术复习2 | Fallenk&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="第四讲OpenGL核心编程 可编程管线介绍 顶点着色器 像素着色器">
<meta name="keywords" content="考试">
<meta property="og:type" content="article">
<meta property="og:title" content="三维动画与交互技术复习2">
<meta property="og:url" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/index.html">
<meta property="og:site_name" content="Fallenk&#39;s Blog">
<meta property="og:description" content="第四讲OpenGL核心编程 可编程管线介绍 顶点着色器 像素着色器">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo15.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo16.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo17.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo18.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo19.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo20.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo21.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo22.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo23.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo24.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo25.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo26.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo27.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo28.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo29.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo30.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo31.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo32.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo33.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo34.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo35.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo36.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo37.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo38.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo39.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo40.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo41.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo42.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo43.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo44.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo45.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo46.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo47.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo48.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo49.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo50.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo51.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo52.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo53.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo54.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo55.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo56.png">
<meta property="og:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo57.png">
<meta property="og:updated_time" content="2019-01-08T14:41:00.035Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="三维动画与交互技术复习2">
<meta name="twitter:description" content="第四讲OpenGL核心编程 可编程管线介绍 顶点着色器 像素着色器">
<meta name="twitter:image" content="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/demo15.png">
  
    <link rel="alternate" href="/atom.xml" title="Fallenk&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    
    <div id="header-inner" class="inner">
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://fallenk.github.io"></form>
      </div>
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">首页</a>
        
          <a class="main-nav-link" href="/archives">归档</a>
        
          <a class="main-nav-link" href="/about">关于</a>
        
      </nav>
      
    </div>
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Fallenk&#39;s Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">经历，心得，笔记，目标</a>
        </h2>
      
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-三维动画与交互技术复习2" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/01/07/三维动画与交互技术复习2/" class="article-date">
  <time datetime="2019-01-07T13:54:10.000Z" itemprop="datePublished">2019-01-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/游戏开发/">游戏开发</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      三维动画与交互技术复习2
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- Table of Contents -->
        
        <h1 id="第四讲"><a href="#第四讲" class="headerlink" title="第四讲"></a>第四讲</h1><h2 id="OpenGL核心编程"><a href="#OpenGL核心编程" class="headerlink" title="OpenGL核心编程"></a>OpenGL核心编程</h2><ol>
<li>可编程管线介绍</li>
<li>顶点着色器</li>
<li>像素着色器</li>
</ol>
<a id="more"></a>
<h2 id="OpenGL渲染管线的概念"><a href="#OpenGL渲染管线的概念" class="headerlink" title="OpenGL渲染管线的概念"></a>OpenGL渲染管线的概念</h2><ul>
<li><strong>渲染</strong>：计算机根据<strong>模型</strong>创建<strong>图像</strong><ul>
<li><strong>模型(或物体)是由几何图元构成的</strong>，几何图元是通过顶点来指定的。(OpenGL将点、直线、多边形、图形和位图视为图元)</li>
<li><strong>最终渲染的图像由屏幕像素组成</strong>。<ul>
<li>像素(pixel)是显示硬件能够放置屏幕上的最小的可视元素。</li>
<li>有关像素的信息(如颜色)在系统内存中被组织为位面(bitplane)</li>
<li>位面构成了帧缓存(包含推行显示设备为控制屏幕上所有像素的颜色和亮度所需的信息)。</li>
</ul>
</li>
</ul>
</li>
<li>渲染的过程<ol>
<li><strong>建模</strong>：<strong>使用几何图元建立模型</strong>，从而得到物体的数学描述</li>
<li><strong>变换</strong>：在三维空间<strong>排列物体</strong>，选择观察场景的有利位置</li>
<li><strong>着色</strong>：计算所有物体的颜色。<ul>
<li>颜色可由<strong>应用程序指定的，根据光照条件确定的、将纹理粘贴到物体上得到的，也可能是上述多种操作</strong>的结果。</li>
</ul>
</li>
<li><strong>光栅化</strong>：将<strong>物体的数学描述和相关的颜色信息</strong>转换为屏幕像素。</li>
</ol>
</li>
</ul>
<h2 id="OpenGL渲染管线"><a href="#OpenGL渲染管线" class="headerlink" title="OpenGL渲染管线"></a>OpenGL渲染管线</h2><h3 id="渲染管线"><a href="#渲染管线" class="headerlink" title="渲染管线"></a>渲染管线</h3><ul>
<li>渲染管线概念<ul>
<li>当我们把<strong>绘制的图形传递给OpenGL</strong>后，OpenGL还要做许多工作，才能<strong>完成3D空间到屏幕的投影</strong>。这一系列的过程被称为OpenGL渲染流水线。</li>
<li>一般的渲染流水线过程有如下几步：<ol>
<li>显示列表</li>
<li>求值程序</li>
<li>顶点程序</li>
<li>图元装配</li>
<li>像素操作</li>
<li>纹理操作</li>
<li>光栅化</li>
<li>片断操作<br><img src="/2019/01/07/三维动画与交互技术复习2/demo15.png" alt=""><br><img src="/2019/01/07/三维动画与交互技术复习2/demo16.png" alt=""></li>
</ol>
</li>
</ul>
</li>
</ul>
<h3 id="基本步骤"><a href="#基本步骤" class="headerlink" title="基本步骤"></a>基本步骤</h3><ul>
<li><strong>OpenGL建立三维模型的基本步骤</strong><ul>
<li>从三维空间到二维平面，如同用照相机拍照一样，通常要经历以下几个步骤</li>
<li><ol>
<li>将相机置于三角架上，让它对准三维景物(<strong>视点变换</strong>，Viewing Transformation)</li>
</ol>
</li>
<li><ol start="2">
<li>将三维物体放在适当的位置(<strong>模型变换</strong>，Modeling Transformation)</li>
</ol>
</li>
<li><ol start="3">
<li>选择相机镜头并调焦，使三维物体投影在二维胶片上(<strong>投影变化</strong>，Projection Transformation)</li>
</ol>
</li>
<li><ol start="4">
<li>决定二维像片的大小(<strong>视口变换</strong>，View transformation)</li>
</ol>
</li>
<li>这样，一个三维空间里的物体就可以用相应的二维平面物体表示了，也就能在二维的计算机屏幕上正确显示了。</li>
</ul>
</li>
<li>OpenGL中的空间变换<br>  <img src="/2019/01/07/三维动画与交互技术复习2/demo17.png" alt=""></li>
<li>OpenGL渲染管线<br><img src="/2019/01/07/三维动画与交互技术复习2/demo18.png" alt=""><ol>
<li>显示列表<ul>
<li><strong>任何数据，不论它描述的是几何图元还是像素，都是可以保存在显示列表</strong>(display list),供当前或以后使用</li>
<li>若<strong>不把数据保存在显示列表，而是立即处理</strong>，叫立即模式</li>
<li>当一个显示列表执行时，保存的数据就从显示列表中取出，就像在立即模式下直接由应用程序发送的那样。</li>
</ul>
</li>
<li>求值器<ul>
<li><strong>所有的集合图元最终都要通过顶点来描述</strong></li>
<li>参数化曲线和表面最初可能是通过<strong>控制点</strong>以及叫做基函数(basic function)的<strong>多项式函数</strong>进行描述</li>
<li>求值器提供了一种方法，根据<strong>控制点计算表示表面的顶点</strong></li>
<li>这种方法是一种多项式映射，他可以<strong>根据控制点产生表面法线、纹理坐标、颜色以及空间坐标值</strong>。</li>
</ul>
</li>
<li>基于顶点的操作<ul>
<li>对于顶点数据，接下来的一个步骤是“基于顶点的操作”，<strong>就是把顶点变换为图元</strong></li>
<li>有些类型的顶点数据(如空间坐标)是通过 4x4 的浮点矩阵进行变换的。<strong>空间坐标从3D世界的一个位置投影到屏幕上的一个位置</strong>。</li>
<li>如果启用了高级特性，这个阶段就会更加忙碌<ul>
<li>如果启用了纹理，这个阶段还将<strong>生成并变换纹理坐标</strong></li>
<li>如果启用了光照，就需要<strong>综合变换后的顶点、表面法线、光源位置、材料属性以及其他光照信息进行光照计算</strong>；产生最终的颜色值。</li>
</ul>
</li>
</ul>
</li>
<li>图元装配<ul>
<li>图元装配的一个主要内容就是<strong>裁剪</strong>；它的任务就是<strong>消除位于半空间之外的那部分几何图元</strong>，这个半空间是由一个平面所定义的。</li>
<li>这个阶段生成的结果就是完整的<strong>几何图元</strong>，即根据相关颜色、深度(纹理坐标和光栅化等)进行了变换和裁剪的顶点。</li>
</ul>
</li>
<li>像素操作<ul>
<li>首先，来自系统内存的一个数组中的<strong>像素进行解包</strong>，从某种格式(像素的原始格式) 解包为适当数量的数据成分</li>
<li>接着，这些数据被<strong>缩放、偏移</strong>，并根据一幅像素图进行处理</li>
<li>处理结果先进行截取，然后或者写入到纹理内存，或者发送到光栅化阶段</li>
</ul>
</li>
<li>纹理装配<ul>
<li>OpenGL应用程序可以在<strong>几何物体上应用纹理图像</strong></li>
<li>若使用多幅纹理图像，放入纹理对象中</li>
<li>使用纹理对象来帮助控制纹理贴图的缓存和定位</li>
</ul>
</li>
<li>光栅化<ul>
<li>光栅化就是把就是<strong>把几何数据和像素数据装换为片断</strong>(fragment)的过程。<strong>每个片断方块对应与帧缓冲区中的一个像素</strong></li>
<li>把顶点连接起来形成直线或者计算填充多边形的内部像素时，要考虑直线和多边形的点画模式、直线的宽度、点的大小、着色模型以及用于支持抗锯齿处理的覆盖计算</li>
<li>每个片段方块都将具有各自的颜色和深度值</li>
</ul>
</li>
<li>片断操作<ul>
<li>纹理操作：在<strong>纹理内存中为每个片断生成一个纹理单元</strong>(texel,纹理元素),<strong>应用到这个片断上，再组合主颜色和辅助颜色，可能应用一次雾计算</strong></li>
<li>执行裁剪测试、alpha测试、模板测试和深度缓冲区测试</li>
<li><strong>经过完整处理的片断就绘制到适当的帧缓冲区</strong>，最终成为一个像素并到达它的最终栖息地。</li>
</ul>
</li>
</ol>
</li>
</ul>
<h2 id="OpenGL中的固定管线"><a href="#OpenGL中的固定管线" class="headerlink" title="OpenGL中的固定管线"></a>OpenGL中的固定管线</h2><ul>
<li>总结：OpenGL的渲染管线主要分为两个阶段</li>
<li><ol>
<li>首先是<strong>基于顶点的操作</strong>，<strong>然后图元被光栅化</strong>，<strong>产生片断</strong></li>
</ol>
</li>
<li><ol start="2">
<li>在片断写入到帧缓冲区之前进行纹理、雾以及其他<strong>基于片断的操作</strong></li>
</ol>
</li>
<li><strong>变换，光照，纹理坐标，裁剪，光栅化</strong>(把几何数据和像素数据装换为片断), 纹理，颜色求和，雾，反走样，写入帧缓存</li>
</ul>
<h3 id="固定的顶点处理"><a href="#固定的顶点处理" class="headerlink" title="固定的顶点处理"></a>固定的顶点处理</h3><ul>
<li>基于顶点的阶段从<strong>一组顶点属性开始</strong></li>
<li>属性包括对象空间位置、法线、主颜色和辅助颜色以纹理坐标</li>
<li>基于顶点的处理结果是<strong>裁剪空间位置、正面和背面主颜色和辅助颜色、一个雾坐标、纹理坐标、点大小</strong></li>
<li>顶点处理分为4个阶段：顶点变换，光照，纹理坐标和变换，裁剪</li>
</ul>
<h4 id="顶点变换"><a href="#顶点变换" class="headerlink" title="顶点变换"></a>顶点变换</h4><ul>
<li><strong>顶点位置从对象控件变换到剪裁空间</strong><ul>
<li>首先，<strong>对象空间坐标与模型视图矩阵</strong>相乘，使坐标进入到视觉空间</li>
<li>然后，与投影矩阵相乘，进入到裁剪空间</li>
</ul>
</li>
<li><strong>顶点的法线也进行变换</strong>，从对象空间坐标到视觉空间，供光照计算使用<ul>
<li>法线与模型师徒矩阵的逆矩阵相乘，然后归一化</li>
</ul>
</li>
</ul>
<h4 id="光照"><a href="#光照" class="headerlink" title="光照"></a>光照</h4><ul>
<li>光照阶段<strong>接收顶点颜色、法线和位置作为原始数据输入，输出主颜色和辅助颜色</strong></li>
<li>每种光源具有位置、颜色和类型</li>
<li>可以用禁用光源跳过这个阶段</li>
</ul>
<h4 id="纹理坐标生成和变换"><a href="#纹理坐标生成和变换" class="headerlink" title="纹理坐标生成和变换"></a>纹理坐标生成和变换</h4><ul>
<li>纹理坐标OpenGL自动生成或通过顶点相关手动指定</li>
<li>每一个纹理坐标由纹理矩阵进行变换</li>
</ul>
<h4 id="裁剪"><a href="#裁剪" class="headerlink" title="裁剪"></a>裁剪</h4><ul>
<li><strong>前面阶段任何顶点转换结果落在可视区域外面，进行裁剪</strong></li>
<li>被剪裁的顶点丢弃，在图元与可视区域相交处生成新顶点</li>
</ul>
<h3 id="固定的片断操作"><a href="#固定的片断操作" class="headerlink" title="固定的片断操作"></a>固定的片断操作</h3><ul>
<li>用<strong>一个片断以及与它相关的数据作为输入</strong>，包括纹理坐标、主颜色和辅助颜色、雾坐标</li>
<li>基于片断操作的结果是一个<strong>颜色值</strong></li>
<li>基于片断的固定功能管线分为4个阶段：<ul>
<li>纹理应用和环境</li>
<li>颜色求和</li>
<li>雾应用</li>
<li>抗锯齿应用</li>
</ul>
</li>
</ul>
<h4 id="纹理应用和环境"><a href="#纹理应用和环境" class="headerlink" title="纹理应用和环境"></a>纹理应用和环境</h4><ul>
<li>在基于片断的阶段中，纹理应用最重要</li>
<li>在这个阶段中，<strong>接收这个片断的所有纹理坐标一起他的主颜色作为输入，输出一种新的主颜色</strong></li>
</ul>
<h4 id="颜色求和"><a href="#颜色求和" class="headerlink" title="颜色求和"></a>颜色求和</h4><ul>
<li>输入：一个主颜色和一个辅助颜色</li>
<li>输出：一种单一颜色</li>
</ul>
<h4 id="雾应用"><a href="#雾应用" class="headerlink" title="雾应用"></a>雾应用</h4><ul>
<li>启用时，基于一个常量雾颜色混合</li>
<li>基于一个雾因子产生</li>
</ul>
<h4 id="抗锯齿应用"><a href="#抗锯齿应用" class="headerlink" title="抗锯齿应用"></a>抗锯齿应用</h4><ul>
<li>产生平滑效果</li>
</ul>
<h2 id="OpenGL基本几何图元"><a href="#OpenGL基本几何图元" class="headerlink" title="OpenGL基本几何图元"></a>OpenGL基本几何图元</h2><h3 id="基本几何图元"><a href="#基本几何图元" class="headerlink" title="基本几何图元"></a>基本几何图元</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">GL_POINTS - 每个顶点在屏幕上都是一个单独的点</span><br><span class="line">GL_LINES - 每一对顶点定义一个 线段</span><br><span class="line">GL_LINE_STRIP - 从第一个依次经过后续顶点而绘制的线条</span><br><span class="line">GL_TRIANGLES - 每三个顶点定义一个新的三角形</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h3 id="点"><a href="#点" class="headerlink" title="点"></a>点</h3><ul>
<li>GL_POINTS - 每个顶点在屏幕都是单独一个点</li>
<li>最简单图元，一个点的大小为一个像素，可使用glPointSize改变大小</li>
<li>void glPointSize(GLfloat size)</li>
</ul>
<h3 id="线"><a href="#线" class="headerlink" title="线"></a>线</h3><ul>
<li>GL_LINES - 每一对顶点定义一个线段</li>
<li>使用glLineWidth可以设定线宽</li>
</ul>
<h3 id="线带-Line-Strip"><a href="#线带-Line-Strip" class="headerlink" title="线带(Line Strip)"></a>线带(Line Strip)</h3><ul>
<li>GL_LINE_STRIP - 从第一个顶点依次经过后续顶点而绘制的线条</li>
</ul>
<h3 id="线环-Line-Loop"><a href="#线环-Line-Loop" class="headerlink" title="线环(Line Loop)"></a>线环(Line Loop)</h3><ul>
<li>GL_LINE_LOOP - 最后一个顶点和第一个顶点连接</li>
</ul>
<h3 id="三角形"><a href="#三角形" class="headerlink" title="三角形"></a>三角形</h3><ul>
<li>GL_TRIANGLES</li>
<li>环绕属性：逆时针为正方向：glFrontFace改变</li>
</ul>
<h3 id="立即模式"><a href="#立即模式" class="headerlink" title="立即模式"></a>立即模式</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;GLUT/GLUT.h&gt;</span><br><span class="line"></span><br><span class="line">void display() &#123;</span><br><span class="line">    glClear(GL_COLOR_BUFFER_BIT);</span><br><span class="line">    glBegin(GL_POLYGON);</span><br><span class="line">    glVertex2f(-0.5, -0.5);</span><br><span class="line">    glVertex2f(-0.5, 0.5);</span><br><span class="line">    glVertex2f(0.5, 0.5);</span><br><span class="line">    glVertex2f(0.5, -0.5);</span><br><span class="line">    glEnd();</span><br><span class="line">    glFlush();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main(int argc, char ** argv) &#123;</span><br><span class="line">    glutInit(&amp;argc, argv);</span><br><span class="line">    glutCreateWindow(&quot;Xcode Glut Demo&quot;);</span><br><span class="line">    glutDisplayFunc(display);</span><br><span class="line">    glutMainLoop();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="批次容器-GLBatch"><a href="#批次容器-GLBatch" class="headerlink" title="批次容器(GLBatch)"></a>批次容器(GLBatch)</h3><ul>
<li>GLTools的容器类，用存储顶点数据</li>
<li>首先对批次执行初始化<ul>
<li>void GLBatch::Begin()</li>
</ul>
</li>
<li>然后至少复制一个有三分量(x,y,z)顶点组成的数组<ul>
<li>void GLBatch::CopyVertexData3f()</li>
</ul>
</li>
<li>再复制表面法线、颜色和纹理坐标<ul>
<li>void GLBatch::CopyNormalDataf</li>
<li>void GLBatch::CopyColorlData4f</li>
<li>void GLBatch::CopyTexCoordlData2f</li>
</ul>
</li>
<li>完成数据填充<ul>
<li>void GLBatch::End</li>
</ul>
</li>
</ul>
<h3 id="背面剔除"><a href="#背面剔除" class="headerlink" title="背面剔除"></a>背面剔除</h3><p>Q： 出现黑色、</p>
<ul>
<li>画家算法：1. 排序需绘制的图元，绘制从远到近； 低效和资源占用</li>
<li>隐面剔除<ul>
<li>glEnable(GL_CULL_FACE)</li>
<li>glDisable(GL_CULL_FACE)</li>
</ul>
</li>
<li>正面剔除<ul>
<li>glCullFace(GL_BACK)</li>
</ul>
</li>
<li>深度测试<ul>
<li>一个高效消除隐藏表面的技术</li>
<li>绘制像素时，分配z值表示到观察者的距离，同一位置时，Z大于原来则覆盖</li>
<li>开启深度缓存<ul>
<li>glutInitDisplayMode(GLUT_DOUBLE|GLUT_RGBA|GLUT_DEPTH)</li>
</ul>
</li>
<li>启用深度测试<ul>
<li>glEnable(GL_DEPTH_TEST)</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="图形学中数学基础"><a href="#图形学中数学基础" class="headerlink" title="图形学中数学基础"></a>图形学中数学基础</h2><h3 id="向量"><a href="#向量" class="headerlink" title="向量"></a>向量</h3><ul>
<li>三维向量用一个三元组(X,Y,Z)表示<ul>
<li>顶点(Vertex)是一个向量：空间中的一个位置</li>
<li>三维坐标也是一个向量，有长度，方向</li>
<li>空间中的一个点即是顶点也是向量</li>
</ul>
</li>
<li>作用<ul>
<li>表示位置，顶点</li>
<li>表示方向：视线方向，平面方向</li>
<li>单位向量</li>
</ul>
</li>
<li>math3d库<ul>
<li>为GLTools的一部分，封装了向量，矩阵等</li>
<li>M3DVectorf表示一个三维向量(X,Y,Z)</li>
<li>M4DVectorf-四维向量</li>
</ul>
</li>
<li>点乘：余弦值</li>
<li>叉乘：得垂直这两个向量的第三个向量，计算法线；不可交换 m3dCrossProduct</li>
</ul>
<h3 id="矩阵"><a href="#矩阵" class="headerlink" title="矩阵"></a>矩阵</h3><ul>
<li>行和列组成的数据结构，二维数组</li>
<li>作用：空间变换<ul>
<li>旋转，平移，缩放</li>
<li>视图、模型、投影 变换</li>
</ul>
</li>
</ul>
<h3 id="几个基本概念"><a href="#几个基本概念" class="headerlink" title="几个基本概念"></a>几个基本概念</h3><ul>
<li>视图变换：<strong>设定观察者或摄像机位置</strong></li>
<li>模型变换：在场景中<strong>移动物体</strong></li>
<li>模型视图：<strong>模型和视图的一致性</strong></li>
<li>投影变换：设定<strong>视景体的大小和形状</strong></li>
<li>视口变换：<strong>窗口缩放</strong></li>
</ul>
<h3 id="视觉坐标系-右手定制，绝对屏幕坐标系"><a href="#视觉坐标系-右手定制，绝对屏幕坐标系" class="headerlink" title="视觉坐标系 - 右手定制，绝对屏幕坐标系"></a>视觉坐标系 - 右手定制，绝对屏幕坐标系</h3><p><img src="/2019/01/07/三维动画与交互技术复习2/demo19.png" alt=""></p>
<h4 id="视图变换"><a href="#视图变换" class="headerlink" title="视图变换"></a>视图变换</h4><ul>
<li>设<strong>定观察点的位置，以及视线方向</strong></li>
<li>理解为在场景中拜访摄像机<ul>
<li>摄像机所在的位置</li>
<li>摄像机对准的方向</li>
</ul>
</li>
<li>在任何其他变换之前应用视图变换，能够保证与视觉坐标系一致</li>
<li>默认从(0,0,0)看向z轴负方向</li>
<li>正投影中，视点在z轴正无穷远处，可以看到视景体中的任何物体</li>
</ul>
<h4 id="模型变换"><a href="#模型变换" class="headerlink" title="模型变换"></a>模型变换</h4><ul>
<li>模型变换常用<strong>于操作模型和其中的特定对象</strong></li>
<li>将对象移动到需要的位置，然后进行缩放和旋转（注意顺序）</li>
</ul>
<h4 id="模型视图一致性"><a href="#模型视图一致性" class="headerlink" title="模型视图一致性"></a>模型视图一致性</h4><ul>
<li>视图变换和模型变换最后形成一个统一的模型视图矩阵</li>
</ul>
<h4 id="投影变换"><a href="#投影变换" class="headerlink" title="投影变换"></a>投影变换</h4><ul>
<li>投影变换在模型视图变换后使用</li>
<li>实际上定义了<strong>视景体</strong>并创建了<strong>裁剪平面</strong></li>
<li>投影分类<ul>
<li>正投影：所有几何形状按照指定的相对大小在屏幕绘制，</li>
<li>透视投影:近大远小</li>
</ul>
</li>
</ul>
<h4 id="视口变换"><a href="#视口变换" class="headerlink" title="视口变换"></a>视口变换</h4><ul>
<li>从颜色缓冲区到窗口像素之前的映射</li>
<li>影响画面显示的比例； 可进行缩放</li>
</ul>
<h3 id="模型视图矩阵"><a href="#模型视图矩阵" class="headerlink" title="模型视图矩阵"></a>模型视图矩阵</h3><ul>
<li>4x4矩阵</li>
<li>原始顶点坐标是一个四维向量，与模型视图矩阵相乘，得到变换后的新坐标</li>
<li>数学上：向量在右边，左乘一个变换矩阵</li>
<li>在OpenGL中，<strong>向量是行向量</strong>，<strong>矩阵是列主矩阵</strong>，相当于整体转置<br><img src="/2019/01/07/三维动画与交互技术复习2/demo20.png" alt=""></li>
</ul>
<h4 id="矩阵构建"><a href="#矩阵构建" class="headerlink" title="矩阵构建"></a>矩阵构建</h4><ul>
<li>OpenGL中的矩阵不是二维数组，而是一维数组<br><img src="/2019/01/07/三维动画与交互技术复习2/demo21.png" alt=""></li>
<li>矩阵的内存模型<br><img src="/2019/01/07/三维动画与交互技术复习2/demo22.png" alt=""></li>
<li>前三列分别是新坐标系的三个坐标轴方向（为单位向量，正交）</li>
<li>第四列表示平移</li>
</ul>
<h4 id="单位矩阵"><a href="#单位矩阵" class="headerlink" title="单位矩阵"></a>单位矩阵</h4><ul>
<li>将一个向量乘单位矩阵，不变</li>
</ul>
<h4 id="平移"><a href="#平移" class="headerlink" title="平移"></a>平移</h4><ul>
<li>将向量沿着一个或者多个坐标轴方向移动<br><img src="/2019/01/07/三维动画与交互技术复习2/demo23.png" alt=""></li>
</ul>
<h4 id="旋转"><a href="#旋转" class="headerlink" title="旋转"></a>旋转</h4><ul>
<li>绕着坐标轴或任意向量旋转<br><img src="/2019/01/07/三维动画与交互技术复习2/demo24.png" alt=""></li>
</ul>
<h4 id="缩放"><a href="#缩放" class="headerlink" title="缩放"></a>缩放</h4><ul>
<li>沿着三个坐标轴分别按照设定的因子放大或缩小向量<br><img src="/2019/01/07/三维动画与交互技术复习2/demo25.png" alt=""></li>
</ul>
<h4 id="组合变换"><a href="#组合变换" class="headerlink" title="组合变换"></a>组合变换</h4><ul>
<li>完成一个变换，需要组合使用平移、旋转和缩放</li>
<li>变换的组合是通过矩阵的乘法实现的</li>
<li>变换矩阵的相乘顺序 重要<br><img src="/2019/01/07/三维动画与交互技术复习2/demo26.png" alt=""></li>
</ul>
<h3 id="使用模型视图矩阵"><a href="#使用模型视图矩阵" class="headerlink" title="使用模型视图矩阵"></a>使用模型视图矩阵</h3><ul>
<li>函数原型<br><img src="/2019/01/07/三维动画与交互技术复习2/demo27.png" alt=""></li>
<li>首先要构造平移矩阵<br><img src="/2019/01/07/三维动画与交互技术复习2/demo28.png" alt=""></li>
<li>使用平移矩阵<br><img src="/2019/01/07/三维动画与交互技术复习2/demo29.png" alt=""><br><img src="/2019/01/07/三维动画与交互技术复习2/demo30.png" alt=""></li>
</ul>
<h4 id="使用三角形批次"><a href="#使用三角形批次" class="headerlink" title="使用三角形批次"></a>使用三角形批次</h4><ol>
<li>构建三角形批次对象 GLTriangleBatch myCoolObject;</li>
<li>设定最多需要的顶点数目 myCoolObject.BeginMesh(200);</li>
<li>添加三角形数据：顶点，法向，纹理<br> void GLTriangleBatch::AddTriangle(M3DVector3f verts[3], M3DVector3f vNorms[3], M3DVector2f vTexCoords[3])</li>
<li>结束三角形添加  myCoolObject.End()</li>
<li>绘制 myCoolObject.Draw()</li>
</ol>
<h4 id="变换管线"><a href="#变换管线" class="headerlink" title="变换管线"></a>变换管线</h4><p><img src="/2019/01/07/三维动画与交互技术复习2/demo31.png" alt=""></p>
<h3 id="使用矩阵栈"><a href="#使用矩阵栈" class="headerlink" title="使用矩阵栈"></a>使用矩阵栈</h3><p><img src="/2019/01/07/三维动画与交互技术复习2/demo32.png" alt=""><br><img src="/2019/01/07/三维动画与交互技术复习2/demo33.png" alt=""></p>
<h3 id="仿射变换"><a href="#仿射变换" class="headerlink" title="仿射变换"></a>仿射变换</h3><p><img src="/2019/01/07/三维动画与交互技术复习2/demo34.png" alt=""></p>
<h3 id="欧拉角-左手"><a href="#欧拉角-左手" class="headerlink" title="欧拉角 左手"></a>欧拉角 左手</h3><ul>
<li>Yaw（偏航）: 欧拉角向量的y轴</li>
<li>Pitch（俯仰）:欧拉角向量的x轴</li>
<li>Roll（翻滚）:欧拉角向量的z轴<br><img src="/2019/01/07/三维动画与交互技术复习2/demo35.png" alt=""></li>
</ul>
<h2 id="可编程渲染管线-重点"><a href="#可编程渲染管线-重点" class="headerlink" title="可编程渲染管线 重点"></a><strong>可编程渲染管线</strong> 重点</h2><ul>
<li>使用<strong>着色器(shader)代替固定管线的部分阶段</strong></li>
<li>着色器也可以称为程序</li>
<li>着色器<strong>实质是应用程序所定义的自定义程序</strong>，用于接替固定功能关系阶段的职责</li>
<li>分为Vertex shader（顶点着色器）；Fragment shader（片断着色器）<br><img src="/2019/01/07/三维动画与交互技术复习2/demo36.png" alt=""></li>
</ul>
<h3 id="可编程顶点着色器"><a href="#可编程顶点着色器" class="headerlink" title="可编程顶点着色器"></a>可编程顶点着色器</h3><ul>
<li><strong>输入</strong>与被替换的固定管线相同：<strong>空间位置、法线、主颜色和辅助颜色以及纹理坐标</strong></li>
<li>输出：<strong>纹理坐标、颜色、点大小、雾坐标</strong></li>
<li>顶点着色器取代了三个基于顶点的阶段<ul>
<li>代替顶点变换</li>
<li>代替光照</li>
<li>代替纹理坐标处理(产生，变换)</li>
</ul>
</li>
</ul>
<h3 id="固定功能胶水"><a href="#固定功能胶水" class="headerlink" title="固定功能胶水"></a>固定功能胶水</h3><ul>
<li>在顶点着色器和片段着色器之间，保留一些固定功能阶段，作为粘贴两种着色器的胶水<ul>
<li>裁剪阶段：根据可视区域裁剪图元</li>
<li>透视操作:被w所除，规范化</li>
<li>光栅化：接收一个图元经过处理的顶点，把它转为片断(1. 对图元填充 2.对颜色和纹理插值)</li>
</ul>
</li>
</ul>
<h3 id="可编程片段着色器"><a href="#可编程片段着色器" class="headerlink" title="可编程片段着色器"></a>可编程片段着色器</h3><ul>
<li>输入：纹理坐标、主颜色、辅助颜色、雾坐标</li>
<li>输出：颜色值</li>
<li>片段着色器取代了<ul>
<li>1.代替纹理:片段着色器最重要的是进行纹理查找。我们可以在着色器中决定什么时候执行纹理查找，是否进行查找，设置坐标</li>
<li>代替颜色求和： 主颜色+辅助颜色</li>
<li>代替雾：计算雾因子</li>
</ul>
</li>
</ul>
<h3 id="OpenGL着色语言-GLSL"><a href="#OpenGL着色语言-GLSL" class="headerlink" title="OpenGL着色语言(GLSL)"></a>OpenGL着色语言(GLSL)</h3><ul>
<li>对GPU编程的高级语言</li>
<li>与C语言接近<br><img src="/2019/01/07/三维动画与交互技术复习2/demo37.png" alt=""></li>
<li>分析：<ol>
<li>将对象空间的顶点坐标与模型视图矩阵相乘</li>
<li>不加修改地复制主颜色</li>
<li>根据NDC归一化设备坐标值计算辅助颜色<h3 id="着色器对象-shader-Objects"><a href="#着色器对象-shader-Objects" class="headerlink" title="着色器对象(shader Objects)"></a>着色器对象(shader Objects)</h3></li>
</ol>
</li>
<li>GLSL使用两种类型的对象：<strong>着色器对象和程序对象</strong></li>
<li>着色器对象加载着色器文本并对他进行编译</li>
<li>着色器对象是最小的作用单元，需要绑定到”程序”中才能运行</li>
</ul>
<h4 id="创建着色器对象"><a href="#创建着色器对象" class="headerlink" title="创建着色器对象"></a>创建着色器对象</h4><ul>
<li>使用<strong>glCreateShader</strong>函数创建着色器对象</li>
<li>该函数接收一个 <strong>着色器类型</strong>作为参数 顶点或片段着色器</li>
<li>该函数返回一个着色器对象的句柄；返回0表示失败<br><img src="/2019/01/07/三维动画与交互技术复习2/demo38.png" alt=""></li>
</ul>
<h4 id="删除着色器"><a href="#删除着色器" class="headerlink" title="删除着色器"></a>删除着色器</h4><p><img src="/2019/01/07/三维动画与交互技术复习2/demo39.png" alt=""></p>
<h4 id="指定着色器文本"><a href="#指定着色器文本" class="headerlink" title="指定着色器文本"></a>指定着色器文本</h4><ul>
<li><strong>着色器对象的目标是简单接收着色器文本并编译文本</strong></li>
<li>着色器文本可以使字符串常量，也可以从文件读取，或者运行产生字符串</li>
<li>使用glShaderSource载入着色器文本<ul>
<li>第一个参数：着色器对象</li>
<li>第二个参数：字符串数量</li>
<li>第三个参数：字符串数组</li>
<li>第四个参数：字符串长度：若NULL结尾，则无需提供<br><img src="/2019/01/07/三维动画与交互技术复习2/demo40.png" alt=""></li>
</ul>
</li>
</ul>
<p><img src="/2019/01/07/三维动画与交互技术复习2/demo41.png" alt=""></p>
<h4 id="编译着色器"><a href="#编译着色器" class="headerlink" title="编译着色器"></a>编译着色器</h4><ul>
<li>当着色器文本被加载到一个着色器对象之后，需要对它进行编译</li>
<li>使用glCompileShader函数编译<br><img src="/2019/01/07/三维动画与交互技术复习2/demo42.png" alt=""></li>
</ul>
<h4 id="着色器编译"><a href="#着色器编译" class="headerlink" title="着色器编译"></a>着色器编译</h4><ul>
<li>查询编译结果，显示出错信息<ul>
<li>glGetShader得到着色器对象状态<ul>
<li>GL_COMPILE_STATUS返回编译状态</li>
<li>GL_INFO_LOG_LENGTH返回日志信息长度</li>
</ul>
</li>
<li>glGetShaderInfoLog得到日志信息<ul>
<li>第一个参数：着色器对象</li>
<li>第二个参数：日志信息缓存区最大空间</li>
<li>第三个参数：实际返回的日志信息长度</li>
<li>第四个参数：日志信息缓存区指针<br><img src="/2019/01/07/三维动画与交互技术复习2/demo43.png" alt=""></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="程序对象"><a href="#程序对象" class="headerlink" title="程序对象"></a>程序对象</h3><ul>
<li>程序对象作为着色器的<strong>容器</strong>使用，把他们接到一个可执行文件</li>
<li>替换部分指定着色器，目前有：<ul>
<li>顶点着色器</li>
<li>几何着色器</li>
<li>片段着色器</li>
</ul>
</li>
</ul>
<h4 id="程序对象的创建和删除"><a href="#程序对象的创建和删除" class="headerlink" title="程序对象的创建和删除"></a>程序对象的创建和删除</h4><ul>
<li>使用 glCreateProgram创建程序对象</li>
<li>glDeleteProgram<br><img src="/2019/01/07/三维动画与交互技术复习2/demo44.png" alt=""></li>
</ul>
<h4 id="粘附和分离-Attatch-amp-Detatch"><a href="#粘附和分离-Attatch-amp-Detatch" class="headerlink" title="粘附和分离(Attatch &amp; Detatch)"></a>粘附和分离(Attatch &amp; Detatch)</h4><ul>
<li>程序对象是一个容器，着色器需粘附到程序对象上</li>
<li>可以讲多个相同类型的着色器对象粘附到程序对象中，共享函数库</li>
<li>使用glAttatchShader和glDetatchShader<br><img src="/2019/01/07/三维动画与交互技术复习2/demo45.png" alt=""></li>
</ul>
<h4 id="链接程序"><a href="#链接程序" class="headerlink" title="链接程序"></a>链接程序</h4><ul>
<li>使用GLSL进行渲染之前，必须链接程序对象</li>
<li>这个过程接收已经编译过的着色器，链接到一个可执行文件</li>
<li>使用glLinkProgram进行链接 glLinkProgram</li>
</ul>
<h4 id="查询程序连接过程的日志信息"><a href="#查询程序连接过程的日志信息" class="headerlink" title="查询程序连接过程的日志信息"></a>查询程序连接过程的日志信息</h4><p><img src="/2019/01/07/三维动画与交互技术复习2/demo46.png" alt=""></p>
<h4 id="验证程序"><a href="#验证程序" class="headerlink" title="验证程序"></a>验证程序</h4><ul>
<li>程序链接成功之后，还需要进行验证才能确保程序的正确性</li>
<li>使用 glVaildateProgram</li>
</ul>
<h4 id="使用程序"><a href="#使用程序" class="headerlink" title="使用程序"></a>使用程序</h4><ul>
<li>使用 glUseProgram可使用链接好的程序 glUseProgram(myProgram)</li>
<li>参数为0则禁用程序</li>
<li>使用glGetInteger查询</li>
</ul>
<h4 id="着色器使用：总结"><a href="#着色器使用：总结" class="headerlink" title="着色器使用：总结"></a>着色器使用：总结</h4><ul>
<li>两种对象：着色器对象和程序对象</li>
<li>使用过程：<ol>
<li>创建着色器对象： glCreateShader</li>
<li>指定着色器文本：glShaderSource</li>
<li>编译着色器对象：glCompileShader</li>
<li>创建程序对象：glCreateProgram</li>
<li>粘附着色器对象到程序对象:glAttatchShader</li>
<li>链接程序对象：glLinkProgram</li>
<li>验证程序对象：glValidateProgram</li>
<li>使用程序对象：glUseProgram</li>
</ol>
</li>
<li>GLSL中的变量<ul>
<li>变量和函数预先声明， “gl_”</li>
</ul>
</li>
</ul>
<h3 id="向量类型"><a href="#向量类型" class="headerlink" title="向量类型"></a>向量类型</h3><p><img src="/2019/01/07/三维动画与交互技术复习2/demo47.png" alt=""></p>
<p><img src="/2019/01/07/三维动画与交互技术复习2/demo48.png" alt=""></p>
<h4 id="结构体"><a href="#结构体" class="headerlink" title="结构体"></a>结构体</h4><ul>
<li>可嵌套</li>
</ul>
<h4 id="限定符"><a href="#限定符" class="headerlink" title="限定符"></a>限定符</h4><ul>
<li>in、out、inout和uniform</li>
</ul>
<h4 id="操作符"><a href="#操作符" class="headerlink" title="操作符"></a>操作符</h4><p>与C语言类似，但没有操作 &amp; 和 *</p>
<h4 id="构造函数"><a href="#构造函数" class="headerlink" title="构造函数"></a>构造函数</h4><p><img src="/2019/01/07/三维动画与交互技术复习2/demo49.png" alt=""><br><img src="/2019/01/07/三维动画与交互技术复习2/demo50.png" alt=""><br><img src="/2019/01/07/三维动画与交互技术复习2/demo51.png" alt=""></p>
<h3 id="控制流"><a href="#控制流" class="headerlink" title="控制流"></a>控制流</h3><ul>
<li>循环</li>
<li>判断</li>
<li>discard 终止当前着色器</li>
</ul>
<h3 id="GLSL函数"><a href="#GLSL函数" class="headerlink" title="GLSL函数"></a>GLSL函数</h3><ul>
<li>模块化</li>
<li>main函数</li>
<li>void参数可选,但是void返回值必须</li>
<li>不允许递归</li>
</ul>
<h3 id="着色器统一值"><a href="#着色器统一值" class="headerlink" title="着色器统一值"></a>着色器统一值</h3><ul>
<li>属性是每个顶点位置、表面法向和纹理做白哦等腰需要的，统一值则用于为整个图元批次想保持不变的着色器传递数据</li>
<li>对于顶点着色器，统一值可能是变换矩阵</li>
<li>统一值是只读取的<br><img src="/2019/01/07/三维动画与交互技术复习2/demo52.png" alt=""></li>
<li>1.寻找统一值 着色器编译和链接后，必须在着色器中寻找统一值的额位置，使用 glGetUniformLocation<br><img src="/2019/01/07/三维动画与交互技术复习2/demo53.png" alt=""></li>
<li><p>2.设置统一值<br><img src="/2019/01/07/三维动画与交互技术复习2/demo54.png" alt=""></p>
</li>
<li><p>实例<br><img src="/2019/01/07/三维动画与交互技术复习2/demo55.png" alt=""><br><img src="/2019/01/07/三维动画与交互技术复习2/demo56.png" alt=""></p>
</li>
</ul>
<h3 id="顶点着色器：转换和光照"><a href="#顶点着色器：转换和光照" class="headerlink" title="顶点着色器：转换和光照"></a>顶点着色器：转换和光照</h3><h6 id=""><a href="#" class="headerlink" title=""></a><img src="/2019/01/07/三维动画与交互技术复习2/demo57.png" alt=""></h6>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://fallenk.github.io/2019/01/07/三维动画与交互技术复习2/" data-id="cjz0nwpdd003ga68of3ngq4qn" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/考试/">考试</a></li></ul>

    </footer>
  </div>
  
    
 <script src="/jquery/jquery.min.js"></script>
  <div id="random_posts">
    <h2>推荐文章</h2>
    <div class="random_posts_ul">
      <script>
          var random_count =4
          var site = {BASE_URI:'/'};
          function load_random_posts(obj) {
              var arr=site.posts;
              if (!obj) return;
              // var count = $(obj).attr('data-count') || 6;
              for (var i, tmp, n = arr.length; n; i = Math.floor(Math.random() * n), tmp = arr[--n], arr[n] = arr[i], arr[i] = tmp);
              arr = arr.slice(0, random_count);
              var html = '<ul>';
            
              for(var j=0;j<arr.length;j++){
                var item=arr[j];
                html += '<li><strong>' + 
                item.date + ':&nbsp;&nbsp;<a href="' + (site.BASE_URI+item.uri) + '">' + 
                (item.title || item.uri) + '</a></strong>';
                if(item.excerpt){
                  html +='<div class="post-excerpt">'+item.excerpt+'</div>';
                }
                html +='</li>';
                
              }
              $(obj).html(html + '</ul>');
          }
          $('.random_posts_ul').each(function () {
              var c = this;
              if (!site.posts || !site.posts.length){
                  $.getJSON(site.BASE_URI + 'js/posts.js',function(json){site.posts = json;load_random_posts(c)});
              } 
               else{
                load_random_posts(c);
              }
          });
      </script>
    </div>
  </div>

    
<nav id="article-nav">
  
    <a href="/2019/01/08/三维动画与交互技术复习3/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">上一篇</strong>
      <div class="article-nav-title">
        
          三维动画与交互技术复习3
        
      </div>
    </a>
  
  
    <a href="/2019/01/06/三维动画与交互技术复习/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">下一篇</strong>
      <div class="article-nav-title">三维动画与交互技术复习</div>
    </a>
  
</nav>

  
</article>
 
     
  <div class="comments" id="comments">
    
     
       
      <div id="cloud-tie-wrapper" class="cloud-tie-wrapper"></div>
    
       
      
      
  </div>
 
  

</section>
           
    <aside id="sidebar">
  
    

  
    
    <div class="widget-wrap">
    
      <div class="widget" id="toc-widget-fixed">
      
        <strong class="toc-title">文章目录</strong>
        <div class="toc-widget-list">
              <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#第四讲"><span class="toc-number">1.</span> <span class="toc-text">第四讲</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#OpenGL核心编程"><span class="toc-number">1.1.</span> <span class="toc-text">OpenGL核心编程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OpenGL渲染管线的概念"><span class="toc-number">1.2.</span> <span class="toc-text">OpenGL渲染管线的概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OpenGL渲染管线"><span class="toc-number">1.3.</span> <span class="toc-text">OpenGL渲染管线</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#渲染管线"><span class="toc-number">1.3.1.</span> <span class="toc-text">渲染管线</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#基本步骤"><span class="toc-number">1.3.2.</span> <span class="toc-text">基本步骤</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OpenGL中的固定管线"><span class="toc-number">1.4.</span> <span class="toc-text">OpenGL中的固定管线</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#固定的顶点处理"><span class="toc-number">1.4.1.</span> <span class="toc-text">固定的顶点处理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#顶点变换"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">顶点变换</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#光照"><span class="toc-number">1.4.1.2.</span> <span class="toc-text">光照</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#纹理坐标生成和变换"><span class="toc-number">1.4.1.3.</span> <span class="toc-text">纹理坐标生成和变换</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#裁剪"><span class="toc-number">1.4.1.4.</span> <span class="toc-text">裁剪</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#固定的片断操作"><span class="toc-number">1.4.2.</span> <span class="toc-text">固定的片断操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#纹理应用和环境"><span class="toc-number">1.4.2.1.</span> <span class="toc-text">纹理应用和环境</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#颜色求和"><span class="toc-number">1.4.2.2.</span> <span class="toc-text">颜色求和</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#雾应用"><span class="toc-number">1.4.2.3.</span> <span class="toc-text">雾应用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#抗锯齿应用"><span class="toc-number">1.4.2.4.</span> <span class="toc-text">抗锯齿应用</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OpenGL基本几何图元"><span class="toc-number">1.5.</span> <span class="toc-text">OpenGL基本几何图元</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#基本几何图元"><span class="toc-number">1.5.1.</span> <span class="toc-text">基本几何图元</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#点"><span class="toc-number">1.5.2.</span> <span class="toc-text">点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#线"><span class="toc-number">1.5.3.</span> <span class="toc-text">线</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#线带-Line-Strip"><span class="toc-number">1.5.4.</span> <span class="toc-text">线带(Line Strip)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#线环-Line-Loop"><span class="toc-number">1.5.5.</span> <span class="toc-text">线环(Line Loop)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#三角形"><span class="toc-number">1.5.6.</span> <span class="toc-text">三角形</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#立即模式"><span class="toc-number">1.5.7.</span> <span class="toc-text">立即模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#批次容器-GLBatch"><span class="toc-number">1.5.8.</span> <span class="toc-text">批次容器(GLBatch)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#背面剔除"><span class="toc-number">1.5.9.</span> <span class="toc-text">背面剔除</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#图形学中数学基础"><span class="toc-number">1.6.</span> <span class="toc-text">图形学中数学基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#向量"><span class="toc-number">1.6.1.</span> <span class="toc-text">向量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#矩阵"><span class="toc-number">1.6.2.</span> <span class="toc-text">矩阵</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#几个基本概念"><span class="toc-number">1.6.3.</span> <span class="toc-text">几个基本概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#视觉坐标系-右手定制，绝对屏幕坐标系"><span class="toc-number">1.6.4.</span> <span class="toc-text">视觉坐标系 - 右手定制，绝对屏幕坐标系</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#视图变换"><span class="toc-number">1.6.4.1.</span> <span class="toc-text">视图变换</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#模型变换"><span class="toc-number">1.6.4.2.</span> <span class="toc-text">模型变换</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#模型视图一致性"><span class="toc-number">1.6.4.3.</span> <span class="toc-text">模型视图一致性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#投影变换"><span class="toc-number">1.6.4.4.</span> <span class="toc-text">投影变换</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#视口变换"><span class="toc-number">1.6.4.5.</span> <span class="toc-text">视口变换</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#模型视图矩阵"><span class="toc-number">1.6.5.</span> <span class="toc-text">模型视图矩阵</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#矩阵构建"><span class="toc-number">1.6.5.1.</span> <span class="toc-text">矩阵构建</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#单位矩阵"><span class="toc-number">1.6.5.2.</span> <span class="toc-text">单位矩阵</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#平移"><span class="toc-number">1.6.5.3.</span> <span class="toc-text">平移</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#旋转"><span class="toc-number">1.6.5.4.</span> <span class="toc-text">旋转</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#缩放"><span class="toc-number">1.6.5.5.</span> <span class="toc-text">缩放</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#组合变换"><span class="toc-number">1.6.5.6.</span> <span class="toc-text">组合变换</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用模型视图矩阵"><span class="toc-number">1.6.6.</span> <span class="toc-text">使用模型视图矩阵</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#使用三角形批次"><span class="toc-number">1.6.6.1.</span> <span class="toc-text">使用三角形批次</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#变换管线"><span class="toc-number">1.6.6.2.</span> <span class="toc-text">变换管线</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用矩阵栈"><span class="toc-number">1.6.7.</span> <span class="toc-text">使用矩阵栈</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#仿射变换"><span class="toc-number">1.6.8.</span> <span class="toc-text">仿射变换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#欧拉角-左手"><span class="toc-number">1.6.9.</span> <span class="toc-text">欧拉角 左手</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#可编程渲染管线-重点"><span class="toc-number">1.7.</span> <span class="toc-text">可编程渲染管线 重点</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#可编程顶点着色器"><span class="toc-number">1.7.1.</span> <span class="toc-text">可编程顶点着色器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#固定功能胶水"><span class="toc-number">1.7.2.</span> <span class="toc-text">固定功能胶水</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#可编程片段着色器"><span class="toc-number">1.7.3.</span> <span class="toc-text">可编程片段着色器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#OpenGL着色语言-GLSL"><span class="toc-number">1.7.4.</span> <span class="toc-text">OpenGL着色语言(GLSL)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#着色器对象-shader-Objects"><span class="toc-number">1.7.5.</span> <span class="toc-text">着色器对象(shader Objects)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#创建着色器对象"><span class="toc-number">1.7.5.1.</span> <span class="toc-text">创建着色器对象</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#删除着色器"><span class="toc-number">1.7.5.2.</span> <span class="toc-text">删除着色器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#指定着色器文本"><span class="toc-number">1.7.5.3.</span> <span class="toc-text">指定着色器文本</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#编译着色器"><span class="toc-number">1.7.5.4.</span> <span class="toc-text">编译着色器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#着色器编译"><span class="toc-number">1.7.5.5.</span> <span class="toc-text">着色器编译</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#程序对象"><span class="toc-number">1.7.6.</span> <span class="toc-text">程序对象</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#程序对象的创建和删除"><span class="toc-number">1.7.6.1.</span> <span class="toc-text">程序对象的创建和删除</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#粘附和分离-Attatch-amp-Detatch"><span class="toc-number">1.7.6.2.</span> <span class="toc-text">粘附和分离(Attatch &amp; Detatch)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#链接程序"><span class="toc-number">1.7.6.3.</span> <span class="toc-text">链接程序</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#查询程序连接过程的日志信息"><span class="toc-number">1.7.6.4.</span> <span class="toc-text">查询程序连接过程的日志信息</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#验证程序"><span class="toc-number">1.7.6.5.</span> <span class="toc-text">验证程序</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#使用程序"><span class="toc-number">1.7.6.6.</span> <span class="toc-text">使用程序</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#着色器使用：总结"><span class="toc-number">1.7.6.7.</span> <span class="toc-text">着色器使用：总结</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#向量类型"><span class="toc-number">1.7.7.</span> <span class="toc-text">向量类型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#结构体"><span class="toc-number">1.7.7.1.</span> <span class="toc-text">结构体</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#限定符"><span class="toc-number">1.7.7.2.</span> <span class="toc-text">限定符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#操作符"><span class="toc-number">1.7.7.3.</span> <span class="toc-text">操作符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#构造函数"><span class="toc-number">1.7.7.4.</span> <span class="toc-text">构造函数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#控制流"><span class="toc-number">1.7.8.</span> <span class="toc-text">控制流</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GLSL函数"><span class="toc-number">1.7.9.</span> <span class="toc-text">GLSL函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#着色器统一值"><span class="toc-number">1.7.10.</span> <span class="toc-text">着色器统一值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#顶点着色器：转换和光照"><span class="toc-number">1.7.11.</span> <span class="toc-text">顶点着色器：转换和光照</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#"><span class="toc-number">1.7.11.0.0.1.</span> <span class="toc-text"></span></a></li></ol></li></ol></li></ol></li></ol></li></ol></li></ol>
          </div>
      </div>
    </div>

  
    

  
    
  
    
  
    

  
    
  
    <!--微信公众号二维码-->


  
</aside>

      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-left">
      &copy; 2014 - 2019 Fallenk Liu&nbsp;|&nbsp;
      主题 <a href="https://github.com/giscafer/hexo-theme-cafe/" target="_blank">Cafe</a>
    </div>
     <div id="footer-right">
      联系方式&nbsp;|&nbsp;fallenk_liu@yeah.com
    </div>
  </div>
</footer>
 <script src="/jquery/jquery.min.js"></script>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
    <a href="/about" class="mobile-nav-link">关于</a>
  
</nav>
    <img class="back-to-top-btn" src="/images/fly-to-top.png"/>
<script>
// Elevator script included on the page, already.
window.onload = function() {
  var elevator = new Elevator({
    selector:'.back-to-top-btn',
    element: document.querySelector('.back-to-top-btn'),
    duration: 1000 // milliseconds
  });
}
</script>
      

  
    <script>
      var cloudTieConfig = {
        url: document.location.href, 
        sourceId: "",
        productKey: "e2fb4051c49842688ce669e634bc983f",
        target: "cloud-tie-wrapper"
      };
    </script>
    <script src="https://img1.ws.126.net/f2e/tie/yun/sdk/loader.js"></script>
    

  







<!-- author:forvoid begin -->
<!-- author:forvoid begin -->

<!-- author:forvoid end -->

<!-- author:forvoid end -->


  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      })
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      })
    </script>
    <script type="text/javascript" src="https://cdn.rawgit.com/mathjax/MathJax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


 <script src="/js/is.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>
<script src="/js/elevator.js"></script>
  </div>
</body>
</html>